(()=>{var e={};e.id=57,e.ids=[57],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},72425:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>p,tree:()=>l}),r(98894),r(93428),r(35866);var i=r(23191),s=r(88716),a=r(37922),o=r.n(a),n=r(95231),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);r.d(t,d);let l=["",{children:["favorites",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,98894)),"/home/deo/Desktop/bois/app/favorites/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,93428)),"/home/deo/Desktop/bois/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/deo/Desktop/bois/app/favorites/page.tsx"],m="/favorites/page",u={require:r,loadChunk:()=>Promise.resolve()},p=new i.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/favorites/page",pathname:"/favorites",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},99527:(e,t,r)=>{Promise.resolve().then(r.bind(r,70561))},70561:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var i=r(10326),s=r(90434),a=r(57671),o=r(67427),n=r(38239),d=r(18298),l=r(17577);function c(){let{items:e,removeFavorite:t}=(0,n.t)(),{addItem:r}=(0,d.x)(),[c,m]=(0,l.useState)(null),u=async e=>{await r({id:e.id,name:e.name,price:e.price,image:e.image}),m(e.id),setTimeout(()=>m(null),2e3)};return i.jsx("div",{className:"py-12 sm:py-16 md:py-20",children:(0,i.jsxs)("div",{className:"container mx-auto px-4 sm:px-6",children:[i.jsx("h1",{className:"text-4xl font-bold text-wood-900 mb-2",children:"Mes Favoris"}),i.jsx("p",{className:"text-wood-600 mb-12",children:"Produits que vous avez sauvegard\xe9s"}),e.length>0?i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden hover:shadow-lg transition",children:[e.image?i.jsx("div",{className:"h-48 bg-wood-100 overflow-hidden flex items-center justify-center",children:i.jsx("img",{src:e.image,alt:e.name,className:"w-full h-full object-cover"})}):i.jsx("div",{className:"bg-wood-100 h-48 flex items-center justify-center",children:i.jsx("span",{className:"text-wood-400 text-sm",children:"Image produit"})}),(0,i.jsxs)("div",{className:"p-4",children:[i.jsx("h3",{className:"font-semibold text-wood-900 mb-2",children:e.name}),(0,i.jsxs)("p",{className:"text-fire-600 font-bold mb-4",children:[e.price,"â‚½"]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsxs)("button",{onClick:()=>u(e),className:`flex-1 py-2 rounded transition text-sm font-semibold flex items-center justify-center gap-2 ${c===e.id?"bg-green-600 text-white":"bg-fire-600 text-white hover:bg-fire-700"}`,children:[i.jsx(a.Z,{size:16}),c===e.id?"Ajout\xe9!":"Ajouter"]}),i.jsx("button",{onClick:()=>t(e.id),className:"p-2 hover:bg-red-100 rounded transition",title:"Supprimer des favoris",children:i.jsx(o.Z,{size:18,className:"text-red-600 fill-red-600"})})]})]})]},e.id))}):(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[i.jsx(o.Z,{className:"mx-auto text-wood-300 mb-4",size:48}),i.jsx("p",{className:"text-wood-600 mb-6",children:"Vous n'avez pas encore de favoris"}),i.jsx(s.default,{href:"/catalogue",className:"inline-block bg-fire-600 text-white px-6 py-2 rounded-lg hover:bg-fire-700 transition",children:"D\xe9couvrir le catalogue"})]})]})})}},38239:(e,t,r)=>{"use strict";r.d(t,{t:()=>o});var i=r(60114),s=r(85251);let a=(0,r(42945).e)(),o=(0,i.Ue)()((0,s.tJ)((e,t)=>({items:[],isSyncing:!1,addFavorite:async r=>{if(!t().isFavorite(r.id)){e({items:[...t().items,r]});let{data:{user:i}}=await a.auth.getUser();if(i)try{let{error:e}=await a.from("user_favorites").upsert({user_id:i.id,product_id:r.id,product_name:r.name,price:r.price},{onConflict:"user_id,product_id"});if(e)throw e}catch(e){console.error("Error syncing favorite to Supabase:",e)}}},removeFavorite:async r=>{e({items:t().items.filter(e=>e.id!==r)});let{data:{user:i}}=await a.auth.getUser();if(i)try{let{error:e}=await a.from("user_favorites").delete().eq("user_id",i.id).eq("product_id",r);if(e)throw e}catch(e){console.error("Error removing favorite from Supabase:",e)}},isFavorite:e=>t().items.some(t=>t.id===e),toggleFavorite:async e=>{t().isFavorite(e.id)?await t().removeFavorite(e.id):await t().addFavorite(e)},syncWithSupabase:async r=>{if(!t().isSyncing){e({isSyncing:!0});try{let i=t().items,{data:s,error:o}=await a.from("user_favorites").select("*").eq("user_id",r);if(o)throw o;if(s&&s.length>0){let t=s.map(e=>({id:e.product_id,name:e.product_name,price:e.price}));e({items:t})}else if(i.length>0)for(let e of i)await a.from("user_favorites").upsert({user_id:r,product_id:e.id,product_name:e.name,price:e.price},{onConflict:"user_id,product_id"})}catch(e){console.error("Error syncing favorites with Supabase:",e)}finally{e({isSyncing:!1})}}},loadFromSupabase:async t=>{try{let{data:r,error:i}=await a.from("user_favorites").select("*").eq("user_id",t);if(i)throw i;if(r&&r.length>0){let t=r.map(e=>({id:e.product_id,name:e.product_name,price:e.price}));e({items:t})}}catch(e){console.error("Error loading favorites from Supabase:",e)}}}),{name:"favorites-storage",storage:(0,s.FL)(()=>localStorage)}))},98894:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});let i=(0,r(68570).createProxy)(String.raw`/home/deo/Desktop/bois/app/favorites/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[9276,9797,9888],()=>r(72425));module.exports=i})();