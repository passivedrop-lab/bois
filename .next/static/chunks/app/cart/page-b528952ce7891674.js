(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[565],{2884:function(e,t,i){Promise.resolve().then(i.bind(i,7789))},7789:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return l}});var s=i(7437),r=i(7648);let a=(0,i(9763).Z)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var n=i(9397),c=i(8930),o=i(6275),d=i(7008);function l(){let{items:e,removeItem:t,updateQuantity:i,clearCart:l,getTotal:u}=(0,d.x)();return(0,s.jsx)("div",{className:"py-12 sm:py-16 md:py-20",children:(0,s.jsxs)("div",{className:"container mx-auto px-4 sm:px-6",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-wood-900 mb-2",children:"Mon Panier"}),(0,s.jsx)("p",{className:"text-wood-600 mb-8",children:"V\xe9rifiez et modifiez vos articles"}),e.length>0?(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,s.jsx)("div",{className:"lg:col-span-2 space-y-4",children:e.map(e=>(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 flex items-center justify-between",children:[e.image&&(0,s.jsx)("div",{className:"w-20 h-20 bg-wood-100 rounded mr-4 flex-shrink-0 flex items-center justify-center",children:(0,s.jsx)("img",{src:e.image,alt:e.name,className:"w-full h-full object-cover rounded"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"font-semibold text-wood-900",children:e.name}),(0,s.jsxs)("p",{className:"text-sm text-wood-600",children:["Prix: ",e.price,"₽"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:()=>e.quantity>1&&i(e.id,e.quantity-1),className:"p-1 hover:bg-wood-100 rounded",children:(0,s.jsx)(a,{size:18,className:"text-wood-600"})}),(0,s.jsx)("span",{className:"px-4 font-semibold",children:e.quantity}),(0,s.jsx)("button",{onClick:()=>i(e.id,e.quantity+1),className:"p-1 hover:bg-wood-100 rounded",children:(0,s.jsx)(n.Z,{size:18,className:"text-wood-600"})})]}),(0,s.jsx)("button",{onClick:()=>t(e.id),className:"p-1 hover:bg-red-100 rounded ml-4",children:(0,s.jsx)(c.Z,{size:18,className:"text-red-600"})})]},e.id))}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 h-fit",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-wood-900 mb-4",children:"R\xe9sum\xe9"}),(0,s.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,s.jsxs)("div",{className:"flex justify-between text-wood-600",children:[(0,s.jsx)("span",{children:"Sous-total"}),(0,s.jsxs)("span",{children:[u(),"₽"]})]}),(0,s.jsxs)("div",{className:"flex justify-between text-wood-600",children:[(0,s.jsx)("span",{children:"Livraison"}),(0,s.jsx)("span",{children:"\xc0 d\xe9finir"})]}),(0,s.jsxs)("div",{className:"border-t border-wood-200 pt-3 flex justify-between font-bold text-wood-900",children:[(0,s.jsx)("span",{children:"Total"}),(0,s.jsxs)("span",{children:[u(),"₽"]})]})]}),(0,s.jsx)("button",{className:"w-full bg-fire-600 text-white py-3 rounded-lg hover:bg-fire-700 transition font-semibold mb-3",children:(0,s.jsx)(r.default,{href:"/checkout",children:"Passer la commande"})}),(0,s.jsx)("button",{onClick:()=>l(),className:"w-full border border-wood-300 text-wood-700 py-2 rounded-lg hover:bg-wood-50 transition font-semibold",children:"Vider le panier"})]})]}):(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[(0,s.jsx)(o.Z,{className:"mx-auto text-wood-300 mb-4",size:48}),(0,s.jsx)("p",{className:"text-wood-600 mb-6",children:"Votre panier est vide"}),(0,s.jsx)(r.default,{href:"/catalogue",className:"inline-block bg-fire-600 text-white px-6 py-2 rounded-lg hover:bg-fire-700 transition",children:"Continuer les achats"})]})]})})}},7008:function(e,t,i){"use strict";i.d(t,{x:function(){return n}});var s=i(9625),r=i(6885);let a=(0,i(970).e)(),n=(0,s.Ue)()((0,r.tJ)((e,t)=>({items:[],isSyncing:!1,addItem:async i=>{let s=t().items.find(e=>e.id===i.id)?t().items.map(e=>e.id===i.id?{...e,quantity:e.quantity+1}:e):[...t().items,{...i,quantity:1}];e({items:s});let{data:{user:r}}=await a.auth.getUser();if(r)try{let e=s.find(e=>e.id===i.id);if(e){let{error:t}=await a.from("user_cart").upsert({user_id:r.id,product_id:i.id,product_name:i.name,price:i.price,quantity:e.quantity},{onConflict:"user_id,product_id"});if(t)throw t}}catch(e){console.error("Error syncing cart to Supabase:",e)}},removeItem:async i=>{e({items:t().items.filter(e=>e.id!==i)});let{data:{user:s}}=await a.auth.getUser();if(s)try{let{error:e}=await a.from("user_cart").delete().eq("user_id",s.id).eq("product_id",i);if(e)throw e}catch(e){console.error("Error removing item from Supabase:",e)}},updateQuantity:async(i,s)=>{if(s<=0){await t().removeItem(i);return}e({items:t().items.map(e=>e.id===i?{...e,quantity:s}:e)});let{data:{user:r}}=await a.auth.getUser();if(r)try{let{error:e}=await a.from("user_cart").update({quantity:s}).eq("user_id",r.id).eq("product_id",i);if(e)throw e}catch(e){console.error("Error updating quantity in Supabase:",e)}},clearCart:async()=>{e({items:[]});let{data:{user:t}}=await a.auth.getUser();if(t)try{let{error:e}=await a.from("user_cart").delete().eq("user_id",t.id);if(e)throw e}catch(e){console.error("Error clearing cart from Supabase:",e)}},syncWithSupabase:async i=>{if(!t().isSyncing){e({isSyncing:!0});try{let s=t().items,{data:r,error:n}=await a.from("user_cart").select("*").eq("user_id",i);if(n)throw n;if(r&&r.length>0){let t=r.map(e=>({id:e.product_id,name:e.product_name,price:e.price,quantity:e.quantity}));e({items:t})}else if(s.length>0)for(let e of s)await a.from("user_cart").upsert({user_id:i,product_id:e.id,product_name:e.name,price:e.price,quantity:e.quantity},{onConflict:"user_id,product_id"})}catch(e){console.error("Error syncing cart with Supabase:",e)}finally{e({isSyncing:!1})}}},loadFromSupabase:async t=>{try{let{data:i,error:s}=await a.from("user_cart").select("*").eq("user_id",t);if(s)throw s;if(i&&i.length>0){let t=i.map(e=>({id:e.product_id,name:e.product_name,price:e.price,quantity:e.quantity}));e({items:t})}}catch(e){console.error("Error loading cart from Supabase:",e)}},getTotal:()=>t().items.reduce((e,t)=>e+t.price*t.quantity,0),getItemCount:()=>t().items.reduce((e,t)=>e+t.quantity,0)}),{name:"cart-storage",storage:(0,r.FL)(()=>localStorage)}))},970:function(e,t,i){"use strict";i.d(t,{e:function(){return r}});var s=i(2990);function r(){let e="https://foyiurrbytmcwgspbyay.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZveWl1cnJieXRtY3dnc3BieWF5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc4NTk1MjgsImV4cCI6MjA4MzQzNTUyOH0.K1HzmpmPM-BU_aprU0xJjYpE5PajGjDEh6PjBM2O2ZM";if(!e||!t)throw Error("Missing Supabase environment variables. Please check your .env.local file.");return(0,s.createBrowserClient)(e,t)}},9397:function(e,t,i){"use strict";i.d(t,{Z:function(){return s}});let s=(0,i(9763).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},8930:function(e,t,i){"use strict";i.d(t,{Z:function(){return s}});let s=(0,i(9763).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}},function(e){e.O(0,[451,53,393,971,117,744],function(){return e(e.s=2884)}),_N_E=e.O()}]);