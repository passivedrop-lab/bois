(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{627:function(e,t,s){Promise.resolve().then(s.t.bind(s,7960,23)),Promise.resolve().then(s.bind(s,1265)),Promise.resolve().then(s.bind(s,8407)),Promise.resolve().then(s.bind(s,1123)),Promise.resolve().then(s.t.bind(s,2972,23))},1265:function(e,t,s){"use strict";s.d(t,{a:function(){return l}});var a=s(7437),r=s(2265),i=s(970),n=s(9376);let o=(0,r.createContext)({user:null,loading:!0,signOut:async()=>{}});t.default=function(e){let{children:t}=e,[s,l]=(0,r.useState)(null),[c,d]=(0,r.useState)(!0),u=(0,r.useMemo)(()=>(0,i.e)(),[]),m=(0,n.useRouter)();(0,r.useEffect)(()=>{let e=!0;(async()=>{try{let{data:{user:t},error:s}=await u.auth.getUser();e&&(s?(console.error("Error getting user:",s),l(null)):l(t),d(!1))}catch(t){console.error("Error getting user:",t),e&&(l(null),d(!1))}})();let{data:{subscription:t}}=u.auth.onAuthStateChange(async(t,s)=>{if(e)try{var a;l(null!==(a=null==s?void 0:s.user)&&void 0!==a?a:null),d(!1),"SIGNED_IN"===t&&m.refresh()}catch(e){console.error("Error in auth state change:",e),l(null),d(!1)}});return()=>{e=!1,null==t||t.unsubscribe()}},[m,u]);let h=async()=>{try{let{error:e}=await u.auth.signOut();if(e)throw e;l(null),m.push("/"),m.refresh()}catch(e){console.error("Error signing out:",e),m.push("/")}};return(0,a.jsx)(o.Provider,{value:{user:s,loading:c,signOut:h},children:t})};let l=()=>(0,r.useContext)(o)},8407:function(e,t,s){"use strict";s.d(t,{default:function(){return g}});var a=s(7437),r=s(2265),i=s(7648),n=s(9376);let o=(0,s(9763).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);var l=s(2369),c=s(3247),d=s(8997),u=s(6275),m=s(7692),h=s(2489),f=s(6840),x=s(1265),p=s(7008);function g(){var e,t;let[s,g]=(0,r.useState)(!1),[y,w]=(0,r.useState)(!1),{user:b,signOut:v}=(0,x.a)(),j=(0,p.x)(e=>e.getItemCount());(0,n.usePathname)();let N=[{name:"Главная",href:"/"},{name:"Каталог",href:"/catalogue"},{name:"Услуги",href:"/services"},{name:"Доставка",href:"/livraison"},{name:"О нас",href:"/a-propos"},{name:"Контакты",href:"/contacts"}],k=[{name:"Строительная древесина",href:"/catalogue/bois-de-construction"},{name:"Пиломатериалы",href:"/catalogue/bois-sci\xe9"},{name:"Дрова",href:"/catalogue/bois-de-chauffage"},{name:"Древесина для сауны",href:"/catalogue/bois-sauna"},{name:"Декоративная древесина",href:"/catalogue/bois-decoratif"},{name:"Панели",href:"/catalogue/panneaux"},{name:"Древесина для наружных работ",href:"/catalogue/bois-exterieur"},{name:"Необработанная/промышленная древесина",href:"/catalogue/bois-brut-industriel"}];return(0,a.jsxs)("header",{className:"bg-white shadow-lg sticky top-0 z-50",children:[(0,a.jsx)("div",{className:"bg-wood-900 text-white py-2",children:(0,a.jsx)("div",{className:"container mx-auto px-4",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-2 sm:gap-0 text-xs sm:text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 sm:gap-4",children:[(0,a.jsxs)("a",{href:"tel:+79991234567",className:"flex items-center gap-1.5 sm:gap-2 hover:text-fire-400 transition whitespace-nowrap",children:[(0,a.jsx)(o,{size:14,className:"sm:w-4 sm:h-4"}),(0,a.jsx)("span",{className:"text-xs sm:text-sm",children:"+7 (999) 123-45-67"})]}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Доставка по всей России"})]}),(0,a.jsx)("div",{className:"flex items-center gap-3 sm:gap-4",children:b?(0,a.jsxs)(i.default,{href:"/profile",className:"flex items-center gap-1.5 sm:gap-2 hover:text-fire-400 transition whitespace-nowrap",children:[(0,a.jsx)(l.Z,{size:14,className:"sm:w-4 sm:h-4"}),(0,a.jsx)("span",{className:"hidden xs:inline text-xs sm:text-sm",children:"Мой профиль"})]}):(0,a.jsxs)(i.default,{href:"/login",className:"flex items-center gap-1.5 sm:gap-2 hover:text-fire-400 transition whitespace-nowrap",children:[(0,a.jsx)(l.Z,{size:14,className:"sm:w-4 sm:h-4"}),(0,a.jsx)("span",{className:"text-xs sm:text-sm",children:"Вход / Регистрация"})]})})]})})}),(0,a.jsx)("nav",{className:"bg-white py-3 shadow-md",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 flex justify-between items-center",children:[(0,a.jsxs)(i.default,{href:"/",className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-shrink-0",children:[(0,a.jsx)("div",{className:"bg-fire-600 text-white p-2 sm:p-3 rounded-lg flex-shrink-0",children:(0,a.jsx)("span",{className:"text-xl sm:text-2xl font-bold",children:"TS"})}),(0,a.jsxs)("div",{className:"min-w-0 hidden xs:block",children:[(0,a.jsx)("h1",{className:"text-lg sm:text-xl md:text-2xl font-serif font-bold text-wood-900 truncate",children:"TsarstvoDereva"}),(0,a.jsx)("p",{className:"text-xs text-wood-600 hidden sm:block",children:"Качество и надежность"})]})]}),(0,a.jsx)("nav",{className:"hidden lg:flex items-center gap-8",children:N.map(e=>(0,a.jsx)(i.default,{href:e.href,className:"text-wood-700 hover:text-fire-600 font-medium transition-colors",children:e.name},e.name))}),(0,a.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 lg:gap-4 flex-shrink-0",children:[(0,a.jsx)("button",{className:"p-1.5 sm:p-2 hover:bg-wood-100 rounded-lg transition","aria-label":"Поиск",children:(0,a.jsx)(c.Z,{size:18,className:"sm:w-6 sm:h-6 text-wood-700"})}),(0,a.jsx)(i.default,{href:"/favorites",className:"relative p-1.5 sm:p-2 hover:bg-wood-100 rounded-lg transition","aria-label":"Избранное",children:(0,a.jsx)(d.Z,{size:18,className:"sm:w-6 sm:h-6 text-wood-700"})}),(0,a.jsxs)(i.default,{href:"/cart",className:"relative p-1.5 sm:p-2 hover:bg-wood-100 rounded-lg transition","aria-label":"Корзина",children:[(0,a.jsx)(u.Z,{size:18,className:"sm:w-6 sm:h-6 text-wood-700"}),j>0&&(0,a.jsx)("span",{className:"absolute -top-1 -right-1 bg-fire-600 text-white text-[10px] sm:text-xs rounded-full w-4 h-4 sm:w-5 sm:h-5 flex items-center justify-center font-bold",children:j>9?"9+":j})]}),b&&(0,a.jsxs)("div",{className:"relative hidden sm:block",children:[(0,a.jsx)("button",{onClick:()=>w(!y),className:"p-1.5 sm:p-2 hover:bg-wood-100 rounded-lg transition","aria-label":"Мой профиль",children:(0,a.jsx)("div",{className:"w-7 h-7 sm:w-8 sm:h-8 bg-gradient-to-br from-fire-500 to-fire-700 rounded-full flex items-center justify-center text-white text-xs sm:text-sm font-bold",children:(null===(t=b.email)||void 0===t?void 0:null===(e=t[0])||void 0===e?void 0:e.toUpperCase())||"U"})}),y&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-2xl border border-wood-100 overflow-hidden z-50",children:[(0,a.jsx)(i.default,{href:"/profile",className:"block px-4 py-3 hover:bg-wood-50 transition text-wood-700",onClick:()=>w(!1),children:"Мой профиль"}),(0,a.jsx)(i.default,{href:"/profile/orders",className:"block px-4 py-3 hover:bg-wood-50 transition text-wood-700",onClick:()=>w(!1),children:"Мои заказы"}),(0,a.jsxs)("button",{onClick:async()=>{await v(),w(!1)},className:"w-full text-left px-4 py-3 hover:bg-wood-50 transition text-wood-700 flex items-center gap-2",children:[(0,a.jsx)(m.Z,{size:16}),"Выйти"]})]})]}),(0,a.jsx)("button",{onClick:()=>g(!s),className:"lg:hidden p-1.5 sm:p-2 hover:bg-wood-100 rounded-lg transition","aria-label":"Меню",children:s?(0,a.jsx)(h.Z,{size:20,className:"sm:w-6 sm:h-6 text-wood-700"}):(0,a.jsx)(f.Z,{size:20,className:"sm:w-6 sm:h-6 text-wood-700"})})]})]})}),(0,a.jsx)("div",{className:"bg-gray-100 py-2",children:(0,a.jsx)("div",{className:"container mx-auto px-4 flex gap-4 overflow-x-auto",children:k.map(e=>(0,a.jsx)("a",{href:e.href,className:"text-sm text-gray-700 hover:text-fire-400 whitespace-nowrap",children:e.name},e.href))})}),s&&(0,a.jsx)("div",{className:"lg:hidden bg-white border-t border-wood-200",children:(0,a.jsxs)("nav",{className:"container mx-auto px-4 py-4 space-y-2",children:[N.map(e=>(0,a.jsx)(i.default,{href:e.href,className:"block py-2 text-wood-700 hover:text-fire-600 font-medium transition-colors",onClick:()=>g(!1),children:e.name},e.name)),(0,a.jsxs)("div",{className:"pt-4 border-t border-wood-200 mt-2",children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-wood-900 mb-2",children:"Категории:"}),k.map(e=>(0,a.jsx)(i.default,{href:e.href,className:"block py-2 text-sm text-wood-600 hover:text-fire-600 transition-colors",onClick:()=>g(!1),children:e.name},e.name))]})]})})]})}},1123:function(e,t,s){"use strict";s.d(t,{default:function(){return i}});var a=s(7437),r=s(9064);function i(){return(0,a.jsx)(r.x7,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#fff",color:"#783410",borderRadius:"12px",padding:"16px",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.1)"},success:{iconTheme:{primary:"#ea580c",secondary:"#fff"}},error:{iconTheme:{primary:"#dc2626",secondary:"#fff"}}}})}},7008:function(e,t,s){"use strict";s.d(t,{x:function(){return n}});var a=s(9625),r=s(6885);let i=(0,s(970).e)(),n=(0,a.Ue)()((0,r.tJ)((e,t)=>({items:[],isSyncing:!1,addItem:async s=>{let a=t().items.find(e=>e.id===s.id)?t().items.map(e=>e.id===s.id?{...e,quantity:e.quantity+1}:e):[...t().items,{...s,quantity:1}];e({items:a});let{data:{user:r}}=await i.auth.getUser();if(r)try{let e=a.find(e=>e.id===s.id);if(e){let{error:t}=await i.from("user_cart").upsert({user_id:r.id,product_id:s.id,product_name:s.name,price:s.price,quantity:e.quantity},{onConflict:"user_id,product_id"});if(t)throw t}}catch(e){console.error("Error syncing cart to Supabase:",e)}},removeItem:async s=>{e({items:t().items.filter(e=>e.id!==s)});let{data:{user:a}}=await i.auth.getUser();if(a)try{let{error:e}=await i.from("user_cart").delete().eq("user_id",a.id).eq("product_id",s);if(e)throw e}catch(e){console.error("Error removing item from Supabase:",e)}},updateQuantity:async(s,a)=>{if(a<=0){await t().removeItem(s);return}e({items:t().items.map(e=>e.id===s?{...e,quantity:a}:e)});let{data:{user:r}}=await i.auth.getUser();if(r)try{let{error:e}=await i.from("user_cart").update({quantity:a}).eq("user_id",r.id).eq("product_id",s);if(e)throw e}catch(e){console.error("Error updating quantity in Supabase:",e)}},clearCart:async()=>{e({items:[]});let{data:{user:t}}=await i.auth.getUser();if(t)try{let{error:e}=await i.from("user_cart").delete().eq("user_id",t.id);if(e)throw e}catch(e){console.error("Error clearing cart from Supabase:",e)}},syncWithSupabase:async s=>{if(!t().isSyncing){e({isSyncing:!0});try{let a=t().items,{data:r,error:n}=await i.from("user_cart").select("*").eq("user_id",s);if(n)throw n;if(r&&r.length>0){let t=r.map(e=>({id:e.product_id,name:e.product_name,price:e.price,quantity:e.quantity}));e({items:t})}else if(a.length>0)for(let e of a)await i.from("user_cart").upsert({user_id:s,product_id:e.id,product_name:e.name,price:e.price,quantity:e.quantity},{onConflict:"user_id,product_id"})}catch(e){console.error("Error syncing cart with Supabase:",e)}finally{e({isSyncing:!1})}}},loadFromSupabase:async t=>{try{let{data:s,error:a}=await i.from("user_cart").select("*").eq("user_id",t);if(a)throw a;if(s&&s.length>0){let t=s.map(e=>({id:e.product_id,name:e.product_name,price:e.price,quantity:e.quantity}));e({items:t})}}catch(e){console.error("Error loading cart from Supabase:",e)}},getTotal:()=>t().items.reduce((e,t)=>e+t.price*t.quantity,0),getItemCount:()=>t().items.reduce((e,t)=>e+t.quantity,0)}),{name:"cart-storage",storage:(0,r.FL)(()=>localStorage)}))},970:function(e,t,s){"use strict";s.d(t,{e:function(){return r}});var a=s(2990);function r(){let e="https://foyiurrbytmcwgspbyay.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZveWl1cnJieXRtY3dnc3BieWF5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc4NTk1MjgsImV4cCI6MjA4MzQzNTUyOH0.K1HzmpmPM-BU_aprU0xJjYpE5PajGjDEh6PjBM2O2ZM";if(!e||!t)throw Error("Missing Supabase environment variables. Please check your .env.local file.");return(0,a.createBrowserClient)(e,t)}},7692:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},6840:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]])},3247:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},2369:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},2489:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},7960:function(){}},function(e){e.O(0,[587,451,53,393,195,971,117,744],function(){return e(e.s=627)}),_N_E=e.O()}]);