(()=>{var e={};e.id=8606,e.ids=[8606],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},64177:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>p,tree:()=>o}),t(40377),t(93428),t(35866);var i=t(23191),r=t(88716),a=t(37922),n=t.n(a),d=t(95231),l={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>d[e]);t.d(s,l);let o=["",{children:["admin",{children:["orders",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,40377)),"/home/deo/Desktop/bois/app/admin/orders/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,93428)),"/home/deo/Desktop/bois/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/deo/Desktop/bois/app/admin/orders/page.tsx"],x="/admin/orders/page",m={require:t,loadChunk:()=>Promise.resolve()},p=new i.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/orders/page",pathname:"/admin/orders",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},49057:(e,s,t)=>{Promise.resolve().then(t.bind(t,70688))},70688:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var i=t(10326),r=t(17577),a=t(35047),n=t(90434),d=t(86333),l=t(76557);let o=(0,l.Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var c=t(3240);let x=(0,l.Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var m=t(94019),p=t(95157);function u(){(0,a.useRouter)();let[e,s]=(0,r.useState)(!1),[t,l]=(0,r.useState)([]),[u,h]=(0,r.useState)(null),[b,j]=(0,r.useState)(!1),[g,f]=(0,r.useState)(!0),[y,w]=(0,r.useState)(""),[v,N]=(0,r.useState)(!1),I=async e=>{N(!0);try{if(!t.find(s=>s.id===e))return;let s="https://yiygigafhnlwzdsbzdsj.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlpeWdpZ2FmaG5sd3pkc2J6ZHNqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc3MDYwMjgsImV4cCI6MjA4MzI4MjAyOH0.-f7tLNsGdofpwwtphm0ouRcIj02Ir2RiDzgyvskPs68";if(s&&i){let t=(0,p.eI)(s,i);await t.from("orders").update({status:"verified"}).eq("id",e)}l(t.map(s=>s.id===e?{...s,status:"verified"}:s)),j(!1),alert("✅ Commande valid\xe9e! Un email de confirmation a \xe9t\xe9 envoy\xe9.")}catch(e){alert("❌ Erreur lors de la validation")}finally{N(!1)}},k=async e=>{if(!y.trim()){alert("Veuillez entrer une raison de rejet");return}N(!0);try{if(!t.find(s=>s.id===e))return;let s="https://yiygigafhnlwzdsbzdsj.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlpeWdpZ2FmaG5sd3pkc2J6ZHNqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc3MDYwMjgsImV4cCI6MjA4MzI4MjAyOH0.-f7tLNsGdofpwwtphm0ouRcIj02Ir2RiDzgyvskPs68";if(s&&i){let t=(0,p.eI)(s,i);await t.from("orders").update({status:"rejected",rejection_reason:y}).eq("id",e)}l(t.map(s=>s.id===e?{...s,status:"rejected"}:s)),j(!1),w(""),alert(`✅ Commande rejet\xe9e. Un email d'explication a \xe9t\xe9 envoy\xe9 au client.`)}catch(e){alert("❌ Erreur lors du rejet")}finally{N(!1)}},z=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"verified":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-wood-100 text-wood-800"}},_=e=>{switch(e){case"pending":return"En attente";case"verified":return"Valid\xe9e";case"rejected":return"Rejet\xe9e";default:return e}};return g||!e?null:(0,i.jsxs)("div",{className:"min-h-screen bg-wood-100",children:[i.jsx("div",{className:"bg-white border-b border-wood-200 p-6",children:(0,i.jsxs)("div",{className:"flex items-center gap-4",children:[i.jsx(n.default,{href:"/admin",className:"p-2 hover:bg-wood-100 rounded-lg transition",children:i.jsx(d.Z,{size:20})}),(0,i.jsxs)("h1",{className:"text-3xl font-bold text-wood-900",children:["Gestion des commandes (",t.length,")"]})]})}),i.jsx("div",{className:"p-6",children:0===t.length?i.jsx("div",{className:"text-center py-12",children:i.jsx("p",{className:"text-wood-600 text-lg",children:"Aucune commande pour le moment"})}):i.jsx("div",{className:"grid gap-4",children:t.map(e=>(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 hover:shadow-lg transition",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("h3",{className:"font-bold text-wood-900 text-lg",children:["#",e.id]}),(0,i.jsxs)("p",{className:"text-sm text-wood-600",children:[new Date(e.created_at).toLocaleDateString("fr-FR")," - ",e.customer_name||e.customer_email]})]}),i.jsx("span",{className:`px-4 py-2 rounded-full font-semibold text-sm ${z(e.status)}`,children:_(e.status)})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"text-2xl font-bold text-fire-600",children:[e.total.toLocaleString(),"₽"]}),i.jsx("p",{className:"text-xs text-wood-500 mt-1",children:e.customer_email})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsxs)("button",{onClick:()=>{h(e),j(!0),w("")},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[i.jsx(o,{size:18}),"D\xe9tails"]}),"pending"===e.status&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("button",{onClick:()=>I(e.id),disabled:v,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition disabled:opacity-50",children:[v?i.jsx(c.Z,{size:18,className:"animate-spin"}):i.jsx(x,{size:18}),"Valider"]}),(0,i.jsxs)("button",{onClick:()=>{h(e),j(!0),w("")},className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition",children:[i.jsx(m.Z,{size:18}),"Rejeter"]})]})]})]})]},e.id))})}),b&&u&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-auto",children:[(0,i.jsxs)("div",{className:"sticky top-0 bg-white border-b border-wood-200 p-6 flex items-center justify-between",children:[(0,i.jsxs)("h2",{className:"text-2xl font-bold text-wood-900",children:["D\xe9tails - Commande #",u.id]}),i.jsx("button",{onClick:()=>j(!1),className:"text-wood-500 hover:text-wood-700 text-2xl",children:"✕"})]}),(0,i.jsxs)("div",{className:"p-6 space-y-6",children:[(0,i.jsxs)("div",{children:[i.jsx("h3",{className:"font-bold text-wood-900 mb-3",children:"Informations client"}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm bg-wood-50 p-4 rounded-lg",children:[(0,i.jsxs)("div",{children:[i.jsx("p",{className:"text-wood-600",children:"Nom"}),i.jsx("p",{className:"font-semibold",children:u.customer_name||"-"})]}),(0,i.jsxs)("div",{children:[i.jsx("p",{className:"text-wood-600",children:"Email"}),i.jsx("p",{className:"font-semibold text-sm",children:u.customer_email})]}),(0,i.jsxs)("div",{children:[i.jsx("p",{className:"text-wood-600",children:"Adresse"}),i.jsx("p",{className:"font-semibold",children:u.shipping_address})]}),(0,i.jsxs)("div",{children:[i.jsx("p",{className:"text-wood-600",children:"Ville"}),i.jsx("p",{className:"font-semibold",children:u.shipping_city})]})]})]}),(0,i.jsxs)("div",{children:[i.jsx("h3",{className:"font-bold text-wood-900 mb-3",children:"R\xe9capitulatif"}),(0,i.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,i.jsxs)("div",{className:"flex justify-between mb-3",children:[i.jsx("span",{className:"font-semibold",children:"Montant:"}),(0,i.jsxs)("span",{className:"font-bold text-fire-600 text-lg",children:[u.total.toLocaleString(),"₽"]})]}),(0,i.jsxs)("div",{className:"flex justify-between mb-3",children:[i.jsx("span",{className:"font-semibold",children:"Statut:"}),i.jsx("span",{className:`font-bold px-3 py-1 rounded-full text-sm ${z(u.status)}`,children:_(u.status)})]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[i.jsx("span",{className:"font-semibold",children:"Date:"}),i.jsx("span",{children:new Date(u.created_at).toLocaleDateString("fr-FR")})]})]})]}),"pending"===u.status&&(0,i.jsxs)("div",{children:[i.jsx("h3",{className:"font-bold text-wood-900 mb-3",children:"En cas de rejet"}),i.jsx("textarea",{placeholder:"Raison du rejet (obligatoire si rejet)...",value:y,onChange:e=>w(e.target.value),className:"w-full px-4 py-3 border border-wood-200 rounded-lg focus:outline-none focus:border-fire-600 focus:ring-2 focus:ring-fire-100 resize-none",rows:3})]}),(0,i.jsxs)("div",{className:"flex gap-4 pt-4 border-t border-wood-200",children:["pending"===u.status&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("button",{onClick:()=>I(u.id),disabled:v,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:[v?i.jsx(c.Z,{size:18,className:"animate-spin"}):i.jsx(x,{size:18}),"Valider"]}),(0,i.jsxs)("button",{onClick:()=>k(u.id),disabled:v||!y.trim(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:[v?i.jsx(c.Z,{size:18,className:"animate-spin"}):i.jsx(m.Z,{size:18}),"Rejeter"]})]}),i.jsx("button",{onClick:()=>j(!1),disabled:v,className:"flex-1 px-4 py-3 border border-wood-300 rounded-lg hover:bg-wood-50 transition font-semibold disabled:opacity-50",children:"pending"===u.status?"Annuler":"Fermer"})]})]})]})})]})}},86333:(e,s,t)=>{"use strict";t.d(s,{Z:()=>i});let i=(0,t(76557).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},3240:(e,s,t)=>{"use strict";t.d(s,{Z:()=>i});let i=(0,t(76557).Z)("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]])},40377:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});let i=(0,t(68570).createProxy)(String.raw`/home/deo/Desktop/bois/app/admin/orders/page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),i=s.X(0,[9276,9797,9888],()=>t(64177));module.exports=i})();