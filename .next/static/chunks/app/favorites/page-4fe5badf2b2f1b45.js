(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[57],{6276:function(e,t,i){Promise.resolve().then(i.bind(i,6629))},6629:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return l}});var r=i(7437),a=i(7648),s=i(6275),o=i(8997),c=i(663),n=i(7008),d=i(2265);function l(){let{items:e,removeFavorite:t}=(0,c.t)(),{addItem:i}=(0,n.x)(),[l,u]=(0,d.useState)(null),m=async e=>{await i({id:e.id,name:e.name,price:e.price,image:e.image}),u(e.id),setTimeout(()=>u(null),2e3)};return(0,r.jsx)("div",{className:"py-12 sm:py-16 md:py-20",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 sm:px-6",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-wood-900 mb-2",children:"Mes Favoris"}),(0,r.jsx)("p",{className:"text-wood-600 mb-12",children:"Produits que vous avez sauvegard\xe9s"}),e.length>0?(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden hover:shadow-lg transition",children:[e.image?(0,r.jsx)("div",{className:"h-48 bg-wood-100 overflow-hidden flex items-center justify-center",children:(0,r.jsx)("img",{src:e.image,alt:e.name,className:"w-full h-full object-cover"})}):(0,r.jsx)("div",{className:"bg-wood-100 h-48 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-wood-400 text-sm",children:"Image produit"})}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h3",{className:"font-semibold text-wood-900 mb-2",children:e.name}),(0,r.jsxs)("p",{className:"text-fire-600 font-bold mb-4",children:[e.price,"â‚½"]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)("button",{onClick:()=>m(e),className:"flex-1 py-2 rounded transition text-sm font-semibold flex items-center justify-center gap-2 ".concat(l===e.id?"bg-green-600 text-white":"bg-fire-600 text-white hover:bg-fire-700"),children:[(0,r.jsx)(s.Z,{size:16}),l===e.id?"Ajout\xe9!":"Ajouter"]}),(0,r.jsx)("button",{onClick:()=>t(e.id),className:"p-2 hover:bg-red-100 rounded transition",title:"Supprimer des favoris",children:(0,r.jsx)(o.Z,{size:18,className:"text-red-600 fill-red-600"})})]})]})]},e.id))}):(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[(0,r.jsx)(o.Z,{className:"mx-auto text-wood-300 mb-4",size:48}),(0,r.jsx)("p",{className:"text-wood-600 mb-6",children:"Vous n'avez pas encore de favoris"}),(0,r.jsx)(a.default,{href:"/catalogue",className:"inline-block bg-fire-600 text-white px-6 py-2 rounded-lg hover:bg-fire-700 transition",children:"D\xe9couvrir le catalogue"})]})]})})}},7008:function(e,t,i){"use strict";i.d(t,{x:function(){return o}});var r=i(9625),a=i(6885);let s=(0,i(970).e)(),o=(0,r.Ue)()((0,a.tJ)((e,t)=>({items:[],isSyncing:!1,addItem:async i=>{let r=t().items.find(e=>e.id===i.id)?t().items.map(e=>e.id===i.id?{...e,quantity:e.quantity+1}:e):[...t().items,{...i,quantity:1}];e({items:r});let{data:{user:a}}=await s.auth.getUser();if(a)try{let e=r.find(e=>e.id===i.id);if(e){let{error:t}=await s.from("user_cart").upsert({user_id:a.id,product_id:i.id,product_name:i.name,price:i.price,quantity:e.quantity},{onConflict:"user_id,product_id"});if(t)throw t}}catch(e){console.error("Error syncing cart to Supabase:",e)}},removeItem:async i=>{e({items:t().items.filter(e=>e.id!==i)});let{data:{user:r}}=await s.auth.getUser();if(r)try{let{error:e}=await s.from("user_cart").delete().eq("user_id",r.id).eq("product_id",i);if(e)throw e}catch(e){console.error("Error removing item from Supabase:",e)}},updateQuantity:async(i,r)=>{if(r<=0){await t().removeItem(i);return}e({items:t().items.map(e=>e.id===i?{...e,quantity:r}:e)});let{data:{user:a}}=await s.auth.getUser();if(a)try{let{error:e}=await s.from("user_cart").update({quantity:r}).eq("user_id",a.id).eq("product_id",i);if(e)throw e}catch(e){console.error("Error updating quantity in Supabase:",e)}},clearCart:async()=>{e({items:[]});let{data:{user:t}}=await s.auth.getUser();if(t)try{let{error:e}=await s.from("user_cart").delete().eq("user_id",t.id);if(e)throw e}catch(e){console.error("Error clearing cart from Supabase:",e)}},syncWithSupabase:async i=>{if(!t().isSyncing){e({isSyncing:!0});try{let r=t().items,{data:a,error:o}=await s.from("user_cart").select("*").eq("user_id",i);if(o)throw o;if(a&&a.length>0){let t=a.map(e=>({id:e.product_id,name:e.product_name,price:e.price,quantity:e.quantity}));e({items:t})}else if(r.length>0)for(let e of r)await s.from("user_cart").upsert({user_id:i,product_id:e.id,product_name:e.name,price:e.price,quantity:e.quantity},{onConflict:"user_id,product_id"})}catch(e){console.error("Error syncing cart with Supabase:",e)}finally{e({isSyncing:!1})}}},loadFromSupabase:async t=>{try{let{data:i,error:r}=await s.from("user_cart").select("*").eq("user_id",t);if(r)throw r;if(i&&i.length>0){let t=i.map(e=>({id:e.product_id,name:e.product_name,price:e.price,quantity:e.quantity}));e({items:t})}}catch(e){console.error("Error loading cart from Supabase:",e)}},getTotal:()=>t().items.reduce((e,t)=>e+t.price*t.quantity,0),getItemCount:()=>t().items.reduce((e,t)=>e+t.quantity,0)}),{name:"cart-storage",storage:(0,a.FL)(()=>localStorage)}))},663:function(e,t,i){"use strict";i.d(t,{t:function(){return o}});var r=i(9625),a=i(6885);let s=(0,i(970).e)(),o=(0,r.Ue)()((0,a.tJ)((e,t)=>({items:[],isSyncing:!1,addFavorite:async i=>{if(!t().isFavorite(i.id)){e({items:[...t().items,i]});let{data:{user:r}}=await s.auth.getUser();if(r)try{let{error:e}=await s.from("user_favorites").upsert({user_id:r.id,product_id:i.id,product_name:i.name,price:i.price},{onConflict:"user_id,product_id"});if(e)throw e}catch(e){console.error("Error syncing favorite to Supabase:",e)}}},removeFavorite:async i=>{e({items:t().items.filter(e=>e.id!==i)});let{data:{user:r}}=await s.auth.getUser();if(r)try{let{error:e}=await s.from("user_favorites").delete().eq("user_id",r.id).eq("product_id",i);if(e)throw e}catch(e){console.error("Error removing favorite from Supabase:",e)}},isFavorite:e=>t().items.some(t=>t.id===e),toggleFavorite:async e=>{t().isFavorite(e.id)?await t().removeFavorite(e.id):await t().addFavorite(e)},syncWithSupabase:async i=>{if(!t().isSyncing){e({isSyncing:!0});try{let r=t().items,{data:a,error:o}=await s.from("user_favorites").select("*").eq("user_id",i);if(o)throw o;if(a&&a.length>0){let t=a.map(e=>({id:e.product_id,name:e.product_name,price:e.price}));e({items:t})}else if(r.length>0)for(let e of r)await s.from("user_favorites").upsert({user_id:i,product_id:e.id,product_name:e.name,price:e.price},{onConflict:"user_id,product_id"})}catch(e){console.error("Error syncing favorites with Supabase:",e)}finally{e({isSyncing:!1})}}},loadFromSupabase:async t=>{try{let{data:i,error:r}=await s.from("user_favorites").select("*").eq("user_id",t);if(r)throw r;if(i&&i.length>0){let t=i.map(e=>({id:e.product_id,name:e.product_name,price:e.price}));e({items:t})}}catch(e){console.error("Error loading favorites from Supabase:",e)}}}),{name:"favorites-storage",storage:(0,a.FL)(()=>localStorage)}))},970:function(e,t,i){"use strict";i.d(t,{e:function(){return a}});var r=i(2990);function a(){let e="https://yiygigafhnlwzdsbzdsj.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlpeWdpZ2FmaG5sd3pkc2J6ZHNqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc3MDYwMjgsImV4cCI6MjA4MzI4MjAyOH0.-f7tLNsGdofpwwtphm0ouRcIj02Ir2RiDzgyvskPs68";if(!e||!t)throw Error("Missing Supabase environment variables. Please check your .env.local file.");return(0,r.createBrowserClient)(e,t)}},8997:function(e,t,i){"use strict";i.d(t,{Z:function(){return r}});let r=(0,i(9763).Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])}},function(e){e.O(0,[451,53,393,971,117,744],function(){return e(e.s=6276)}),_N_E=e.O()}]);