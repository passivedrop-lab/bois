(()=>{var e={};e.id=8573,e.ids=[8573],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},61570:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>m,tree:()=>l}),t(88917),t(93428),t(35866);var o=t(23191),s=t(88716),a=t(37922),n=t.n(a),i=t(95231),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);t.d(r,d);let l=["",{children:["admin",{children:["products",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,88917)),"/home/deo/Desktop/bois/app/admin/products/new/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,93428)),"/home/deo/Desktop/bois/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/deo/Desktop/bois/app/admin/products/new/page.tsx"],p="/admin/products/new/page",u={require:t,loadChunk:()=>Promise.resolve()},m=new o.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/admin/products/new/page",pathname:"/admin/products/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},49988:(e,r,t)=>{Promise.resolve().then(t.bind(t,74797))},74797:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>u});var o=t(10326),s=t(17577),a=t(35047),n=t(90434),i=t(86333),d=t(63685),l=t(94019);let c=(0,t(76557).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),p=["Bois de construction","Bois sci\xe9","Drova et Biotoplivо","Bois pour sauna","Bois d\xe9coratif","Panneaux et voiles","Bois d'ext\xe9rieur","Bois brut/industriel"];function u(){let e=(0,a.useRouter)(),[r,t]=(0,s.useState)(!1),[u,m]=(0,s.useState)({name:"",category:p[0],price:"",promoPrice:"",description:"",image:null,vedette:!1}),[x,b]=(0,s.useState)(null),[h,g]=(0,s.useState)(!0),[f,v]=(0,s.useState)(null),[j,w]=(0,s.useState)(null),y=e=>{let r=e.target.files?.[0];if(r){if(!r.type.startsWith("image/")){alert("Veuillez s\xe9lectionner une image valide");return}if(r.size>5242880){alert("L'image doit faire moins de 5MB");return}m({...u,image:r});let e=new FileReader;e.onloadend=()=>{b(e.result)},e.readAsDataURL(r)}};return h||!r?null:(0,o.jsxs)("div",{className:"min-h-screen bg-wood-100",children:[o.jsx("div",{className:"bg-white border-b border-wood-200 p-6",children:(0,o.jsxs)("div",{className:"flex items-center gap-4",children:[o.jsx(n.default,{href:"/admin/products",className:"p-2 hover:bg-wood-100 rounded-lg transition",children:o.jsx(i.Z,{size:20})}),o.jsx("h1",{className:"text-3xl font-bold text-wood-900",children:"Добавить товар"})]})}),o.jsx("div",{className:"p-6",children:(0,o.jsxs)("div",{className:"bg-white rounded-lg shadow max-w-2xl",children:[f&&(0,o.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 p-4 rounded-t-lg",children:[o.jsx("p",{className:"font-semibold",children:"Erreur:"}),o.jsx("p",{className:"text-sm mt-1",children:f})]}),j&&(0,o.jsxs)("div",{className:"bg-green-50 border border-green-200 text-green-700 p-4 rounded-t-lg",children:[o.jsx("p",{className:"font-semibold",children:"Succ\xe8s:"}),o.jsx("p",{className:"text-sm mt-1",children:j})]}),(0,o.jsxs)("form",{onSubmit:r=>{if(r.preventDefault(),v(null),w(null),!u.image){v("Veuillez s\xe9lectionner une image");return}(async()=>{g(!0);try{let r=new FormData;r.append("name",u.name),r.append("category",u.category),r.append("price",String(u.price)),u.promoPrice&&r.append("promoPrice",String(u.promoPrice)),r.append("description",u.description),r.append("vedette",String(u.vedette)),u.image&&r.append("image",u.image);let t=await fetch("/api/admin/products",{method:"POST",body:r}),o=await t.json();if(!t.ok)throw Error(o.error||"Erreur cr\xe9ation");w("Товар успешно добавлен!"),setTimeout(()=>e.push("/admin/products"),1500)}catch(r){let e=r instanceof Error?r.message:"Erreur inconnue";console.error("Erreur cr\xe9ation produit:",r),v(`Ошибка при создании товара: ${e}`)}finally{g(!1)}})()},className:"p-8 space-y-6",children:[(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-bold text-wood-900 mb-2",children:"Изображение товара *"}),x?(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{className:"relative inline-block",children:[o.jsx("img",{src:x,alt:"Pr\xe9visualisation",className:"max-w-sm rounded-lg border border-wood-300"}),o.jsx("button",{type:"button",onClick:()=>{m({...u,image:null}),b(null)},className:"absolute top-2 right-2 bg-red-500 text-white p-1 rounded-full hover:bg-red-600 transition",children:o.jsx(l.Z,{size:20})})]}),(0,o.jsxs)("label",{className:"block",children:[(0,o.jsxs)("span",{className:"inline-flex items-center gap-2 bg-wood-100 hover:bg-wood-200 text-wood-900 px-4 py-2 rounded-lg cursor-pointer transition font-semibold",children:[o.jsx(d.Z,{size:18}),"Изменить изображение"]}),o.jsx("input",{type:"file",accept:"image/*",onChange:y,className:"hidden"})]})]}):(0,o.jsxs)("label",{className:"w-full flex flex-col items-center justify-center border-2 border-dashed border-wood-300 rounded-lg p-8 cursor-pointer hover:border-fire-500 hover:bg-fire-50 transition",children:[o.jsx(d.Z,{size:32,className:"text-wood-600 mb-2"}),o.jsx("span",{className:"text-wood-900 font-semibold",children:"Нажмите для выбора изображения"}),o.jsx("span",{className:"text-wood-600 text-sm mt-1",children:"PNG, JPG, WebP (макс. 5 МБ)"}),o.jsx("input",{type:"file",accept:"image/*",onChange:y,className:"hidden",required:!0})]})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-bold text-wood-900 mb-2",children:"Название товара *"}),o.jsx("input",{type:"text",required:!0,value:u.name,onChange:e=>m({...u,name:e.target.value}),className:"w-full px-4 py-2 border border-wood-300 rounded-lg focus:outline-none focus:border-fire-600",placeholder:"пр: Строительное дерево сырье"})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-bold text-wood-900 mb-2",children:"Категория *"}),o.jsx("select",{required:!0,value:u.category,onChange:e=>m({...u,category:e.target.value}),className:"w-full px-4 py-2 border border-wood-300 rounded-lg focus:outline-none focus:border-fire-600",children:p.map(e=>o.jsx("option",{value:e,children:e},e))})]}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-bold text-wood-900 mb-2",children:"Цена (РУБ) *"}),o.jsx("input",{type:"number",required:!0,value:u.price,onChange:e=>m({...u,price:e.target.value}),className:"w-full px-4 py-2 border border-wood-300 rounded-lg focus:outline-none focus:border-fire-600",placeholder:"15000"})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-bold text-wood-900 mb-2",children:"Цена со скидкой (необязательно)"}),o.jsx("input",{type:"number",value:u.promoPrice,onChange:e=>m({...u,promoPrice:e.target.value}),className:"w-full px-4 py-2 border border-wood-300 rounded-lg focus:outline-none focus:border-fire-600",placeholder:"12000"})]})]}),(0,o.jsxs)("div",{children:[o.jsx("label",{className:"block text-sm font-bold text-wood-900 mb-2",children:"Описание *"}),o.jsx("textarea",{required:!0,value:u.description,onChange:e=>m({...u,description:e.target.value}),rows:6,className:"w-full px-4 py-2 border border-wood-300 rounded-lg focus:outline-none focus:border-fire-600",placeholder:"Подробно опишите товар..."})]}),(0,o.jsxs)("div",{className:"flex items-center",children:[o.jsx("input",{type:"checkbox",id:"vedette",checked:u.vedette,onChange:e=>m({...u,vedette:e.target.checked}),className:"w-4 h-4 text-amber-600 border-wood-300 rounded focus:ring-amber-500"}),o.jsx("label",{htmlFor:"vedette",className:"ml-3 text-sm font-medium text-wood-900",children:"Показать этот товар на главной странице как избранный ⭐"})]}),(0,o.jsxs)("div",{className:"flex gap-4 pt-4 border-t border-wood-200",children:[(0,o.jsxs)("button",{type:"submit",className:"flex items-center gap-2 bg-fire-600 text-white px-6 py-2 rounded-lg hover:bg-fire-700 transition font-semibold",children:[o.jsx(c,{size:20}),"Создать товар"]}),o.jsx(n.default,{href:"/admin/products",className:"px-6 py-2 border border-wood-300 rounded-lg hover:bg-wood-50 transition font-semibold",children:"Отмена"})]})]})]})})]})}},86333:(e,r,t)=>{"use strict";t.d(r,{Z:()=>o});let o=(0,t(76557).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},63685:(e,r,t)=>{"use strict";t.d(r,{Z:()=>o});let o=(0,t(76557).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},88917:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>o});let o=(0,t(68570).createProxy)(String.raw`/home/deo/Desktop/bois/app/admin/products/new/page.tsx#default`)}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[9276,9797,9888],()=>t(61570));module.exports=o})();