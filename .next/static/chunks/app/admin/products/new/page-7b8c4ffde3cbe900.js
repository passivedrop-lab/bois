(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[573],{5722:function(e,r,t){Promise.resolve().then(t.bind(t,2066))},2066:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return m}});var o=t(7437),s=t(2265),n=t(9376),i=t(7648),l=t(2660),a=t(7689),d=t(2489);let c=(0,t(9763).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),u=["Bois de construction","Bois sci\xe9","Drova et Biotoplivо","Bois pour sauna","Bois d\xe9coratif","Panneaux et voiles","Bois d'ext\xe9rieur","Bois brut/industriel"];function m(){let e=(0,n.useRouter)(),[r,t]=(0,s.useState)(!1),[m,p]=(0,s.useState)({name:"",category:u[0],price:"",promoPrice:"",description:"",image:null,vedette:!1}),[x,h]=(0,s.useState)(null),[b,f]=(0,s.useState)(!0);(0,s.useEffect)(()=>{localStorage.getItem("adminToken")?(t(!0),f(!1)):e.push("/admin/login")},[e]);let g=e=>{var r;let t=null===(r=e.target.files)||void 0===r?void 0:r[0];if(t){if(!t.type.startsWith("image/")){alert("Veuillez s\xe9lectionner une image valide");return}if(t.size>5242880){alert("L'image doit faire moins de 5MB");return}p({...m,image:t});let e=new FileReader;e.onloadend=()=>{h(e.result)},e.readAsDataURL(t)}};return b||!r?null:(0,o.jsxs)("div",{className:"min-h-screen bg-wood-100",children:[(0,o.jsx)("div",{className:"bg-white border-b border-wood-200 p-6",children:(0,o.jsxs)("div",{className:"flex items-center gap-4",children:[(0,o.jsx)(i.default,{href:"/admin/products",className:"p-2 hover:bg-wood-100 rounded-lg transition",children:(0,o.jsx)(l.Z,{size:20})}),(0,o.jsx)("h1",{className:"text-3xl font-bold text-wood-900",children:"Добавить товар"})]})}),(0,o.jsx)("div",{className:"p-6",children:(0,o.jsx)("div",{className:"bg-white rounded-lg shadow max-w-2xl",children:(0,o.jsxs)("form",{onSubmit:r=>{if(r.preventDefault(),!m.image){alert("Veuillez s\xe9lectionner une image");return}(async()=>{f(!0);try{let r=new FormData;r.append("name",m.name),r.append("category",m.category),r.append("price",String(m.price)),m.promoPrice&&r.append("promoPrice",String(m.promoPrice)),r.append("description",m.description),r.append("vedette",String(m.vedette)),m.image&&r.append("image",m.image);let t=await fetch("/api/admin/products",{method:"POST",body:r}),o=await t.json();if(!t.ok)throw Error(o.error||"Erreur cr\xe9ation");alert("Товар успешно добавлен!"),e.push("/admin/products")}catch(e){console.error("Erreur cr\xe9ation produit:",e),alert("Ошибка при создании товара")}finally{f(!1)}})()},className:"p-8 space-y-6",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-bold text-wood-900 mb-2",children:"Изображение товара *"}),x?(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsxs)("div",{className:"relative inline-block",children:[(0,o.jsx)("img",{src:x,alt:"Pr\xe9visualisation",className:"max-w-sm rounded-lg border border-wood-300"}),(0,o.jsx)("button",{type:"button",onClick:()=>{p({...m,image:null}),h(null)},className:"absolute top-2 right-2 bg-red-500 text-white p-1 rounded-full hover:bg-red-600 transition",children:(0,o.jsx)(d.Z,{size:20})})]}),(0,o.jsxs)("label",{className:"block",children:[(0,o.jsxs)("span",{className:"inline-flex items-center gap-2 bg-wood-100 hover:bg-wood-200 text-wood-900 px-4 py-2 rounded-lg cursor-pointer transition font-semibold",children:[(0,o.jsx)(a.Z,{size:18}),"Изменить изображение"]}),(0,o.jsx)("input",{type:"file",accept:"image/*",onChange:g,className:"hidden"})]})]}):(0,o.jsxs)("label",{className:"w-full flex flex-col items-center justify-center border-2 border-dashed border-wood-300 rounded-lg p-8 cursor-pointer hover:border-fire-500 hover:bg-fire-50 transition",children:[(0,o.jsx)(a.Z,{size:32,className:"text-wood-600 mb-2"}),(0,o.jsx)("span",{className:"text-wood-900 font-semibold",children:"Нажмите для выбора изображения"}),(0,o.jsx)("span",{className:"text-wood-600 text-sm mt-1",children:"PNG, JPG, WebP (макс. 5 МБ)"}),(0,o.jsx)("input",{type:"file",accept:"image/*",onChange:g,className:"hidden",required:!0})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-bold text-wood-900 mb-2",children:"Название товара *"}),(0,o.jsx)("input",{type:"text",required:!0,value:m.name,onChange:e=>p({...m,name:e.target.value}),className:"w-full px-4 py-2 border border-wood-300 rounded-lg focus:outline-none focus:border-fire-600",placeholder:"пр: Строительное дерево сырье"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-bold text-wood-900 mb-2",children:"Категория *"}),(0,o.jsx)("select",{required:!0,value:m.category,onChange:e=>p({...m,category:e.target.value}),className:"w-full px-4 py-2 border border-wood-300 rounded-lg focus:outline-none focus:border-fire-600",children:u.map(e=>(0,o.jsx)("option",{value:e,children:e},e))})]}),(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-bold text-wood-900 mb-2",children:"Цена (РУБ) *"}),(0,o.jsx)("input",{type:"number",required:!0,value:m.price,onChange:e=>p({...m,price:e.target.value}),className:"w-full px-4 py-2 border border-wood-300 rounded-lg focus:outline-none focus:border-fire-600",placeholder:"15000"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-bold text-wood-900 mb-2",children:"Цена со скидкой (необязательно)"}),(0,o.jsx)("input",{type:"number",value:m.promoPrice,onChange:e=>p({...m,promoPrice:e.target.value}),className:"w-full px-4 py-2 border border-wood-300 rounded-lg focus:outline-none focus:border-fire-600",placeholder:"12000"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-bold text-wood-900 mb-2",children:"Описание *"}),(0,o.jsx)("textarea",{required:!0,value:m.description,onChange:e=>p({...m,description:e.target.value}),rows:6,className:"w-full px-4 py-2 border border-wood-300 rounded-lg focus:outline-none focus:border-fire-600",placeholder:"Подробно опишите товар..."})]}),(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("input",{type:"checkbox",id:"vedette",checked:m.vedette,onChange:e=>p({...m,vedette:e.target.checked}),className:"w-4 h-4 text-amber-600 border-wood-300 rounded focus:ring-amber-500"}),(0,o.jsx)("label",{htmlFor:"vedette",className:"ml-3 text-sm font-medium text-wood-900",children:"Показать этот товар на главной странице как избранный ⭐"})]}),(0,o.jsxs)("div",{className:"flex gap-4 pt-4 border-t border-wood-200",children:[(0,o.jsxs)("button",{type:"submit",className:"flex items-center gap-2 bg-fire-600 text-white px-6 py-2 rounded-lg hover:bg-fire-700 transition font-semibold",children:[(0,o.jsx)(c,{size:20}),"Создать товар"]}),(0,o.jsx)(i.default,{href:"/admin/products",className:"px-6 py-2 border border-wood-300 rounded-lg hover:bg-wood-50 transition font-semibold",children:"Отмена"})]})]})})})]})}},2660:function(e,r,t){"use strict";t.d(r,{Z:function(){return o}});let o=(0,t(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},7689:function(e,r,t){"use strict";t.d(r,{Z:function(){return o}});let o=(0,t(9763).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},2489:function(e,r,t){"use strict";t.d(r,{Z:function(){return o}});let o=(0,t(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9376:function(e,r,t){"use strict";var o=t(5475);t.o(o,"usePathname")&&t.d(r,{usePathname:function(){return o.usePathname}}),t.o(o,"useRouter")&&t.d(r,{useRouter:function(){return o.useRouter}})}},function(e){e.O(0,[451,971,117,744],function(){return e(e.s=5722)}),_N_E=e.O()}]);