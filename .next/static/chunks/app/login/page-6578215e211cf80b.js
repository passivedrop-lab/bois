(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{6335:function(e,t,r){Promise.resolve().then(r.bind(r,6374))},6374:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var o=r(7437),n=r(2265),i=r(9345),s=r(6540);function l(){let[e,t]=(0,n.useState)("email"),[r,l]=(0,n.useState)(""),[a,d]=(0,n.useState)(""),[c,u]=(0,n.useState)(""),[m,f]=(0,n.useState)(""),[x,p]=(0,n.useState)(""),[h,b]=(0,n.useState)(""),[y,g]=(0,n.useState)(!1),[w,v]=(0,n.useState)(""),[j,N]=(0,n.useState)(""),k=async e=>{e.preventDefault(),g(!0),v(""),N("");try{let e=await fetch("/api/auth/send-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r})}),o=await e.json();if(!e.ok){v(o.error||"Erreur lors de l'envoi du code"),g(!1);return}N("Code OTP envoy\xe9 \xe0 votre email!"),t("otp")}catch(e){v("Erreur de connexion")}finally{g(!1)}},C=async e=>{e.preventDefault(),g(!0),v(""),N("");try{let e=await fetch("/api/auth/verify-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,otp:a})}),o=await e.json();if(!e.ok){o.needsRegistration?(t("register"),v(""),N("Code v\xe9rifi\xe9! Compl\xe9tez votre profil.")):v(o.error||"Code invalide"),g(!1);return}localStorage.setItem("authToken",o.token),localStorage.setItem("userId",o.userId),localStorage.setItem("userEmail",r),window.location.href="/profile/orders"}catch(e){v("Erreur lors de la v\xe9rification")}finally{g(!1)}},S=async e=>{e.preventDefault(),g(!0),v(""),N("");try{let e=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,firstName:c,lastName:m,phone:x,city:h})}),t=await e.json();if(!e.ok){v(t.error||"Erreur lors de l'inscription"),g(!1);return}localStorage.setItem("authToken",t.token),localStorage.setItem("userId",t.userId),localStorage.setItem("userEmail",r),window.location.href="/profile/orders"}catch(e){v("Erreur lors de l'inscription")}finally{g(!1)}},E=()=>{t("email"),d(""),v(""),N("")};return(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-wood-50 to-white py-12 sm:py-16 md:py-20",children:(0,o.jsx)("div",{className:"container mx-auto px-4 sm:px-6",children:(0,o.jsxs)("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-xl p-8",children:[(0,o.jsxs)("div",{className:"text-center mb-8",children:[(0,o.jsx)(i.Z,{className:"w-12 h-12 mx-auto text-fire-600 mb-4"}),(0,o.jsxs)("h1",{className:"text-2xl font-bold text-wood-900",children:["email"===e&&"Connexion / Inscription","otp"===e&&"V\xe9rification du code","register"===e&&"Compl\xe9tez votre profil"]}),(0,o.jsxs)("p",{className:"text-wood-600 mt-2 text-sm",children:["email"===e&&"Entrez votre email pour continuer","otp"===e&&"Entrez le code re\xe7u par email","register"===e&&"Compl\xe9tez vos informations personnelles"]})]}),w&&(0,o.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:w}),j&&(0,o.jsx)("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg text-green-700 text-sm",children:j}),"email"===e&&(0,o.jsxs)("form",{onSubmit:k,className:"space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-wood-900 mb-2",children:"Email *"}),(0,o.jsx)("input",{type:"email",placeholder:"votre@email.com",value:r,onChange:e=>l(e.target.value),required:!0,className:"w-full px-4 py-3 border border-wood-200 rounded-lg focus:outline-none focus:border-fire-600 focus:ring-2 focus:ring-fire-100"})]}),(0,o.jsxs)("button",{type:"submit",disabled:y,className:"w-full bg-fire-600 text-white py-3 rounded-lg hover:bg-fire-700 transition font-semibold flex items-center justify-center gap-2 disabled:opacity-50",children:[y&&(0,o.jsx)(s.Z,{className:"w-4 h-4 animate-spin"}),"Envoyer un code"]})]}),"otp"===e&&(0,o.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("p",{className:"text-sm text-wood-600 mb-4",children:["Un code \xe0 6 chiffres a \xe9t\xe9 envoy\xe9 \xe0 ",(0,o.jsx)("strong",{children:r})]}),(0,o.jsx)("label",{className:"block text-sm font-medium text-wood-900 mb-2",children:"Code de v\xe9rification *"}),(0,o.jsx)("input",{type:"text",placeholder:"000000",value:a,onChange:e=>d(e.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6,required:!0,className:"w-full px-4 py-3 border border-wood-200 rounded-lg focus:outline-none focus:border-fire-600 focus:ring-2 focus:ring-fire-100 text-center text-2xl tracking-widest"})]}),(0,o.jsxs)("button",{type:"submit",disabled:y||6!==a.length,className:"w-full bg-fire-600 text-white py-3 rounded-lg hover:bg-fire-700 transition font-semibold flex items-center justify-center gap-2 disabled:opacity-50",children:[y&&(0,o.jsx)(s.Z,{className:"w-4 h-4 animate-spin"}),"V\xe9rifier le code"]}),(0,o.jsx)("button",{type:"button",onClick:E,className:"w-full border border-wood-300 text-wood-700 py-2 rounded-lg hover:bg-wood-50 transition font-medium",children:"← Retour"}),(0,o.jsxs)("p",{className:"text-center text-xs text-wood-500",children:["Pas re\xe7u de code? ",(0,o.jsx)("button",{className:"text-fire-600 hover:text-fire-700 font-semibold",children:"Renvoyer"})]})]}),"register"===e&&(0,o.jsxs)("form",{onSubmit:S,className:"space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-wood-900 mb-2",children:"Pr\xe9nom *"}),(0,o.jsx)("input",{type:"text",placeholder:"Jean",value:c,onChange:e=>u(e.target.value),required:!0,className:"w-full px-4 py-3 border border-wood-200 rounded-lg focus:outline-none focus:border-fire-600 focus:ring-2 focus:ring-fire-100"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-wood-900 mb-2",children:"Nom *"}),(0,o.jsx)("input",{type:"text",placeholder:"Dupont",value:m,onChange:e=>f(e.target.value),required:!0,className:"w-full px-4 py-3 border border-wood-200 rounded-lg focus:outline-none focus:border-fire-600 focus:ring-2 focus:ring-fire-100"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-wood-900 mb-2",children:"T\xe9l\xe9phone *"}),(0,o.jsx)("input",{type:"tel",placeholder:"+33 6 12 34 56 78",value:x,onChange:e=>p(e.target.value),required:!0,className:"w-full px-4 py-3 border border-wood-200 rounded-lg focus:outline-none focus:border-fire-600 focus:ring-2 focus:ring-fire-100"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-wood-900 mb-2",children:"Ville *"}),(0,o.jsx)("input",{type:"text",placeholder:"Paris",value:h,onChange:e=>b(e.target.value),required:!0,className:"w-full px-4 py-3 border border-wood-200 rounded-lg focus:outline-none focus:border-fire-600 focus:ring-2 focus:ring-fire-100"})]}),(0,o.jsxs)("button",{type:"submit",disabled:y,className:"w-full bg-fire-600 text-white py-3 rounded-lg hover:bg-fire-700 transition font-semibold flex items-center justify-center gap-2 disabled:opacity-50",children:[y&&(0,o.jsx)(s.Z,{className:"w-4 h-4 animate-spin"}),"Cr\xe9er mon compte"]}),(0,o.jsx)("button",{type:"button",onClick:E,className:"w-full border border-wood-300 text-wood-700 py-2 rounded-lg hover:bg-wood-50 transition font-medium",children:"← Retour"})]})]})})})}},9763:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var o=r(2265),n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),s=(e,t)=>{let r=(0,o.forwardRef)((r,s)=>{let{color:l="currentColor",size:a=24,strokeWidth:d=2,absoluteStrokeWidth:c,className:u="",children:m,...f}=r;return(0,o.createElement)("svg",{ref:s,...n,width:a,height:a,stroke:l,strokeWidth:c?24*Number(d)/Number(a):d,className:["lucide","lucide-".concat(i(e)),u].join(" "),...f},[...t.map(e=>{let[t,r]=e;return(0,o.createElement)(t,r)}),...Array.isArray(m)?m:[m]])});return r.displayName="".concat(e),r}},6540:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});let o=(0,r(9763).Z)("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]])},9345:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});let o=(0,r(9763).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])}},function(e){e.O(0,[971,117,744],function(){return e(e.s=6335)}),_N_E=e.O()}]);