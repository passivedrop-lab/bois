"use strict";(()=>{var e={};e.id=9203,e.ids=[9203],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},30202:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>h,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{POST:()=>l});var o=r(49303),n=r(88716),a=r(60670),i=r(87070),p=r(19692);let u=process.env.SUPABASE_PRODUCT_BUCKET||"product-images";async function l(e){try{if("true"!==process.env.ALLOW_DELETE_ALL)return i.NextResponse.json({error:"Deletion disabled"},{status:403});let t=e.headers.get("x-admin-delete-token"),r=process.env.ADMIN_DELETE_TOKEN;if(!r||t!==r)return i.NextResponse.json({error:"Invalid token"},{status:403});let s=await (0,p.e)();try{let{data:e}=await s.storage.from(u).list("",{limit:1e3});if(e&&e.length>0){let t=e.map(e=>e.name);await s.storage.from(u).remove(t)}}catch(e){console.warn("Erreur suppression fichiers storage (ignoring):",e)}let{error:o}=await s.from("products").delete().neq("id","");if(o)return i.NextResponse.json({error:"Erreur suppression"},{status:500});return i.NextResponse.json({success:!0,message:"Tous les produits ont \xe9t\xe9 supprim\xe9s"})}catch(e){return console.error("POST /api/admin/products/delete-all error:",e),i.NextResponse.json({error:"Erreur serveur"},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/admin/products/delete-all/route",pathname:"/api/admin/products/delete-all",filename:"route",bundlePath:"app/api/admin/products/delete-all/route"},resolvedPagePath:"/home/deo/Desktop/bois/app/api/admin/products/delete-all/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:m,serverHooks:g}=c,x="/api/admin/products/delete-all/route";function h(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}},19692:(e,t,r)=>{r.d(t,{e:()=>n});var s=r(67721),o=r(71615);async function n(){let e=await (0,o.cookies)();return(0,s.createServerClient)("https://yiygigafhnlwzdsbzdsj.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlpeWdpZ2FmaG5sd3pkc2J6ZHNqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc3MDYwMjgsImV4cCI6MjA4MzI4MjAyOH0.-f7tLNsGdofpwwtphm0ouRcIj02Ir2RiDzgyvskPs68",{cookies:{getAll:()=>e.getAll(),setAll(t){try{t.forEach(({name:t,value:r,options:s})=>e.set(t,r,s))}catch{}}}})}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[9276,5972,7857,9702],()=>r(30202));module.exports=s})();